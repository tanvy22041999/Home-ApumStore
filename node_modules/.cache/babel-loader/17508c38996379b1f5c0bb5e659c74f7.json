{"ast":null,"code":"import { takeEvery, fork, all, call, put, delay } from \"redux-saga/effects\";\nimport { get } from \"lodash\";\nimport UIActions from \"../actions/ui\";\nimport ProductsActions, { ProductsActionTypes } from \"../actions/products\";\nimport { getAllProducts, getDetailProduct, getBestSeller, getFavorite, getNewest, getLikeProducts, getRelateProducts, getAllAccessory, compareProduct } from \"../apis/products\";\nimport GroupActions from \"../actions/group\";\n\nfunction* handleGetList({\n  payload\n}) {\n  try {\n    const result = yield call(getAllProducts, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetListSuccess(data.products, data.total));\n  } catch (error) {\n    yield put(ProductsActions.onGetListError(error));\n  }\n}\n\nfunction* handleGetAccessory({\n  payload\n}) {\n  try {\n    const result = yield call(getAllAccessory, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetAccessorySuccess(data.products, data.total));\n  } catch (error) {\n    yield put(ProductsActions.onGetAccessoryError(error));\n  }\n}\n\nfunction* handleGetBestSeller({\n  payload\n}) {\n  yield put(UIActions.showLoading());\n\n  try {\n    const result = yield call(getBestSeller, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetBestSellerSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetBestSellerError(error));\n  }\n\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleGetFavorite({\n  payload\n}) {\n  yield put(UIActions.showLoading());\n\n  try {\n    const result = yield call(getFavorite, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetFavoriteSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetFavoriteError(error));\n  }\n\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleGetNewest({\n  payload\n}) {\n  yield put(UIActions.showLoading());\n\n  try {\n    const result = yield call(getNewest, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetNewestSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetNewestError(error));\n  }\n\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleCompare({\n  payload\n}) {\n  yield put(UIActions.showLoading());\n\n  try {\n    const result = yield call(compareProduct, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onCompareSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onCompareError(error));\n  }\n\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleFilter({\n  payload\n}) {\n  try {\n    yield delay(300);\n    var result = yield call(getAllProducts, { ...payload,\n      limit: 5,\n      active: 1\n    });\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onFilterSuccess(data.products));\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction* handleCompareFilter({\n  payload\n}) {\n  try {\n    yield delay(300);\n    var result = yield call(getAllProducts, { ...payload,\n      limit: 5,\n      active: 1\n    });\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onCompareFilterSuccess(data.products));\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction* handleGetLike({\n  id\n}) {\n  try {\n    const result = yield call(getLikeProducts, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    debugger;\n    yield put(ProductsActions.onGetLikeSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetLikeError(error));\n  }\n}\n\nfunction* handleGetRelate({\n  id\n}) {\n  try {\n    const result = yield call(getRelateProducts, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetRelateSuccess(data.result.recommend));\n  } catch (error) {\n    yield put(ProductsActions.onGetRelateError(error));\n  }\n}\n\nfunction* handleGetDetail({\n  id\n}) {\n  try {\n    const result = yield call(getDetailProduct, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield delay(2000);\n    yield put(ProductsActions.onGetDetailSuccess(data.product));\n    if (data.product.group) yield put(GroupActions.onGetDetail(data.product.group._id));\n  } catch (error) {\n    yield put(ProductsActions.onGetDetailError(error));\n  }\n}\n/**\n *\n */\n\n\nexport function* watchGetList() {\n  yield takeEvery(ProductsActionTypes.GET_LIST, handleGetList);\n}\nexport function* watchCompare() {\n  yield takeEvery(ProductsActionTypes.COMPARE, handleCompare);\n}\nexport function* watchGetAccessory() {\n  yield takeEvery(ProductsActionTypes.GET_ACCESSORY, handleGetAccessory);\n}\nexport function* watchGetBestSeller() {\n  yield takeEvery(ProductsActionTypes.GET_BEST_SELLER, handleGetBestSeller);\n}\nexport function* watchGetFavorite() {\n  yield takeEvery(ProductsActionTypes.GET_FAVORITE, handleGetFavorite);\n}\nexport function* watchGetRelate() {\n  yield takeEvery(ProductsActionTypes.GET_RELATE, handleGetRelate);\n}\nexport function* watchGetLike() {\n  yield takeEvery(ProductsActionTypes.GET_LIKE, handleGetLike);\n}\nexport function* watchGetNewest() {\n  yield takeEvery(ProductsActionTypes.GET_NEWEST, handleGetNewest);\n}\nexport function* watchGetDetail() {\n  yield takeEvery(ProductsActionTypes.GET_DETAIL, handleGetDetail);\n}\nexport function* watchFilter() {\n  yield takeEvery(ProductsActionTypes.FILTER, handleFilter);\n}\nexport function* watchCompareFilter() {\n  yield takeEvery(ProductsActionTypes.COMPARE_FILTER, handleCompareFilter);\n}\nexport default function* rootSaga() {\n  yield all([fork(watchGetList), fork(watchCompare), fork(watchGetAccessory), fork(watchGetBestSeller), fork(watchGetFavorite), fork(watchGetNewest), fork(watchGetLike), fork(watchGetRelate), fork(watchGetDetail), fork(watchFilter), fork(watchCompareFilter)]);\n}","map":{"version":3,"sources":["/Users/vyduong/Documents/Home-ApumStore/src/redux/sagas/products.js"],"names":["takeEvery","fork","all","call","put","delay","get","UIActions","ProductsActions","ProductsActionTypes","getAllProducts","getDetailProduct","getBestSeller","getFavorite","getNewest","getLikeProducts","getRelateProducts","getAllAccessory","compareProduct","GroupActions","handleGetList","payload","result","data","code","onGetListSuccess","products","total","error","onGetListError","handleGetAccessory","onGetAccessorySuccess","onGetAccessoryError","handleGetBestSeller","showLoading","onGetBestSellerSuccess","onGetBestSellerError","hideLoading","handleGetFavorite","onGetFavoriteSuccess","onGetFavoriteError","handleGetNewest","onGetNewestSuccess","onGetNewestError","handleCompare","onCompareSuccess","onCompareError","handleFilter","limit","active","onFilterSuccess","console","log","handleCompareFilter","onCompareFilterSuccess","handleGetLike","id","onGetLikeSuccess","onGetLikeError","handleGetRelate","onGetRelateSuccess","recommend","onGetRelateError","handleGetDetail","onGetDetailSuccess","product","group","onGetDetail","_id","onGetDetailError","watchGetList","GET_LIST","watchCompare","COMPARE","watchGetAccessory","GET_ACCESSORY","watchGetBestSeller","GET_BEST_SELLER","watchGetFavorite","GET_FAVORITE","watchGetRelate","GET_RELATE","watchGetLike","GET_LIKE","watchGetNewest","GET_NEWEST","watchGetDetail","GET_DETAIL","watchFilter","FILTER","watchCompareFilter","COMPARE_FILTER","rootSaga"],"mappings":"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","sourcesContent":["import { takeEvery, fork, all, call, put, delay } from \"redux-saga/effects\";\nimport { get } from \"lodash\";\nimport UIActions from \"../actions/ui\";\nimport ProductsActions, { ProductsActionTypes } from \"../actions/products\";\nimport { \n  getAllProducts, getDetailProduct, getBestSeller, getFavorite, getNewest, getLikeProducts, getRelateProducts,\n  getAllAccessory, compareProduct\n} from \"../apis/products\";\nimport GroupActions from \"../actions/group\";\n\nfunction* handleGetList({ payload }) {\n  try {\n    const result = yield call(getAllProducts, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetListSuccess(data.products, data.total));\n  } catch (error) {\n    yield put(ProductsActions.onGetListError(error));\n  }\n}\n\nfunction* handleGetAccessory({ payload }) {\n  try {\n    const result = yield call(getAllAccessory, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetAccessorySuccess(data.products, data.total));\n  } catch (error) {\n    yield put(ProductsActions.onGetAccessoryError(error));\n  }\n}\n\nfunction* handleGetBestSeller({ payload }) {\n  yield put(UIActions.showLoading());\n  try {\n    const result = yield call(getBestSeller, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetBestSellerSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetBestSellerError(error));\n  }\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleGetFavorite({ payload }) {\n  yield put(UIActions.showLoading());\n  try {\n    const result = yield call(getFavorite, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetFavoriteSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetFavoriteError(error));\n  }\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleGetNewest({ payload }) {\n  yield put(UIActions.showLoading());\n  try {\n    const result = yield call(getNewest, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetNewestSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetNewestError(error));\n  }\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleCompare({ payload }) {\n  yield put(UIActions.showLoading());\n  try {\n    const result = yield call(compareProduct, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onCompareSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onCompareError(error));\n  }\n  yield put(UIActions.hideLoading());\n}\n\nfunction* handleFilter({ payload }) {\n  try {\n    yield delay(300);\n    var result = yield call(getAllProducts, {\n      ...payload,\n      limit: 5,\n      active: 1\n    });\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onFilterSuccess(data.products));\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nfunction* handleCompareFilter({ payload }) {\n  try {\n    yield delay(300);\n    var result = yield call(getAllProducts, {\n      ...payload,\n      limit: 5,\n      active: 1\n    });\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onCompareFilterSuccess(data.products));\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nfunction* handleGetLike({ id }) {\n  try {\n    const result = yield call(getLikeProducts, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    debugger;\n    yield put(ProductsActions.onGetLikeSuccess(data.products));\n  } catch (error) {\n    yield put(ProductsActions.onGetLikeError(error));\n  }\n}\n\nfunction* handleGetRelate({ id }) {\n  try {\n    const result = yield call(getRelateProducts, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield put(ProductsActions.onGetRelateSuccess(data.result.recommend));\n  } catch (error) {\n    yield put(ProductsActions.onGetRelateError(error));\n  }\n}\n\nfunction* handleGetDetail({ id }) {\n  try {\n    const result = yield call(getDetailProduct, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield delay(2000)\n    yield put(ProductsActions.onGetDetailSuccess(data.product));\n    if(data.product.group) yield put(GroupActions.onGetDetail(data.product.group._id))\n  } catch (error) {\n    yield put(ProductsActions.onGetDetailError(error));\n  }\n}\n\n\n/**\n *\n */\nexport function* watchGetList() {\n  yield takeEvery(ProductsActionTypes.GET_LIST, handleGetList);\n}\nexport function* watchCompare() {\n  yield takeEvery(ProductsActionTypes.COMPARE, handleCompare);\n}\nexport function* watchGetAccessory() {\n  yield takeEvery(ProductsActionTypes.GET_ACCESSORY, handleGetAccessory);\n}\nexport function* watchGetBestSeller() {\n  yield takeEvery(ProductsActionTypes.GET_BEST_SELLER, handleGetBestSeller);\n}\nexport function* watchGetFavorite() {\n  yield takeEvery(ProductsActionTypes.GET_FAVORITE, handleGetFavorite);\n}\nexport function* watchGetRelate() {\n  yield takeEvery(ProductsActionTypes.GET_RELATE, handleGetRelate);\n}\nexport function* watchGetLike() {\n  yield takeEvery(ProductsActionTypes.GET_LIKE, handleGetLike);\n}\nexport function* watchGetNewest() {\n  yield takeEvery(ProductsActionTypes.GET_NEWEST, handleGetNewest);\n}\nexport function* watchGetDetail() {\n  yield takeEvery(ProductsActionTypes.GET_DETAIL, handleGetDetail);\n}\nexport function* watchFilter() {\n  yield takeEvery(ProductsActionTypes.FILTER, handleFilter);\n}\nexport function* watchCompareFilter() {\n  yield takeEvery(ProductsActionTypes.COMPARE_FILTER, handleCompareFilter);\n}\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchGetList),\n    fork(watchCompare),\n    fork(watchGetAccessory),\n    fork(watchGetBestSeller),\n    fork(watchGetFavorite),\n    fork(watchGetNewest),\n    fork(watchGetLike),\n    fork(watchGetRelate),\n    fork(watchGetDetail),\n    fork(watchFilter),\n    fork(watchCompareFilter),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}