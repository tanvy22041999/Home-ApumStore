{"ast":null,"code":"import _regeneratorRuntime from\"/Users/vyduong/Desktop/client/Home-ApumStore/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(handleGetList),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(handleGetDetail),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(handleCreate),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(handleUpdate),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(handleDelete),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(watchGetList),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(watchGetDetail),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(watchCreate),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(watchUpdate),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(watchDelete),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(rootSaga);import{takeEvery,fork,all,call,put}from\"redux-saga/effects\";import{get}from\"lodash\";import InstallmentActions,{InstallmentActionTypes}from\"../actions/installment\";import{getAllInstallments,getDetailInstallment,addInstallment,updateInstallment,deleteInstallment}from\"../apis/installment\";import{getUser}from\"../apis/user\";/* Notification */import io from\"socket.io-client\";import NotificationActions from\"../actions/notification\";var socket=io(\"https://be-phonestore.herokuapp.com\");/* Notification */function handleGetList(_ref){var payload,result,data;return _regeneratorRuntime.wrap(function handleGetList$(_context){while(1){switch(_context.prev=_context.next){case 0:payload=_ref.payload;_context.prev=1;_context.next=4;return call(getAllInstallments,payload);case 4:result=_context.sent;data=get(result,\"data\");if(!(data.code!==200)){_context.next=8;break;}throw data;case 8:_context.next=10;return put(InstallmentActions.onGetListSuccess(data.installments,data.total));case 10:_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);_context.next=16;return put(InstallmentActions.onGetListError(_context.t0));case 16:case\"end\":return _context.stop();}}},_marked,null,[[1,12]]);}function handleGetDetail(_ref2){var filters,id,result,data;return _regeneratorRuntime.wrap(function handleGetDetail$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:filters=_ref2.filters,id=_ref2.id;_context2.prev=1;_context2.next=4;return call(getDetailInstallment,id);case 4:result=_context2.sent;data=get(result,\"data\",{});if(!(data.code!==200)){_context2.next=8;break;}throw data;case 8:_context2.next=10;return put(InstallmentActions.onGetDetailSuccess(data.installment));case 10:_context2.next=16;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](1);_context2.next=16;return put(InstallmentActions.onGetDetailError(_context2.t0));case 16:case\"end\":return _context2.stop();}}},_marked2,null,[[1,12]]);}/**\n *\n * create\n */function handleCreate(_ref3){var payload,result,data,userRes,instRes;return _regeneratorRuntime.wrap(function handleCreate$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref3.payload;_context3.prev=1;_context3.next=4;return call(addInstallment,payload.params);case 4:result=_context3.sent;data=get(result,\"data\",{});if(!(data.code!==201)){_context3.next=8;break;}throw data;case 8:_context3.next=10;return put(InstallmentActions.onCreateSuccess(data.installment));case 10:_context3.next=12;return put(InstallmentActions.onGetList());case 12:_context3.next=14;return call(getUser,payload.params.user);case 14:userRes=_context3.sent;_context3.next=17;return call(getDetailInstallment,data.installment.id);case 17:instRes=_context3.sent;/* Notification */socket.emit(\"installment\",{email:userRes.data.user.email,installment:data.installment.id});_context3.next=21;return put(NotificationActions.onCreate({name:\"Yêu cầu trả góp mới cần duyệt\",image:instRes.data.installment.product.id.bigimage.id,link:data.installment.id,type:2,content:\"\".concat(userRes.data.user.email,\" v\\u1EEBa g\\u1EEDi y\\xEAu c\\u1EA7u tr\\u1EA3 g\\xF3p cho s\\u1EA3n ph\\u1EA9m\")}));case 21:_context3.next=27;break;case 23:_context3.prev=23;_context3.t0=_context3[\"catch\"](1);_context3.next=27;return put(InstallmentActions.onCreateError(_context3.t0));case 27:case\"end\":return _context3.stop();}}},_marked3,null,[[1,23]]);}/**\n *\n * update\n */function handleUpdate(_ref4){var payload,result,data,detailResult,userRes;return _regeneratorRuntime.wrap(function handleUpdate$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:payload=_ref4.payload;_context4.prev=1;_context4.next=4;return call(updateInstallment,payload.data,payload.id);case 4:result=_context4.sent;data=get(result,\"data\",{});if(!(data.code!==200)){_context4.next=8;break;}throw data;case 8:_context4.next=10;return call(getDetailInstallment,payload.id);case 10:detailResult=_context4.sent;_context4.next=13;return put(InstallmentActions.onUpdateSuccess(get(detailResult,\"data\")));case 13:_context4.next=15;return put(InstallmentActions.onGetList());case 15:_context4.next=17;return call(getUser,data.installment.user);case 17:userRes=_context4.sent;if(!payload.data.money){_context4.next=22;break;}socket.emit(\"installmentMoney\",{email:userRes.data.user.email,installment:data.installment.id});_context4.next=22;return put(NotificationActions.onCreate({type:2,user:null,link:data.installment.id,name:\"Phi\\u1EBFu tr\\u1EA3 g\\xF3p \".concat(data.installment.id,\" v\\u1EEBa \\u0111\\u01B0\\u1EE3c thanh to\\xE1n\"),image:detailResult.data.installment.product.id.bigimage.id,content:\"\".concat(data.installment.id,\" \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c thanh to\\xE1n t\\u1EA1i c\\u1EEDa h\\xE0ng v\\u1EDBi s\\u1ED1 ti\\u1EC1n l\\xE0 \").concat(payload.data.money,\" VND\")}));case 22:_context4.next=28;break;case 24:_context4.prev=24;_context4.t0=_context4[\"catch\"](1);_context4.next=28;return put(InstallmentActions.onUpdateError(_context4.t0));case 28:case\"end\":return _context4.stop();}}},_marked4,null,[[1,24]]);}/**\n *\n * delete\n */function handleDelete(_ref5){var id,result,data;return _regeneratorRuntime.wrap(function handleDelete$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:id=_ref5.id;_context5.prev=1;_context5.next=4;return call(deleteInstallment,id);case 4:result=_context5.sent;data=get(result,\"data\",{});if(!(data.code!==200)){_context5.next=8;break;}throw data;case 8:_context5.next=10;return put(InstallmentActions.onDeleteSuccess(data));case 10:_context5.next=12;return put(InstallmentActions.onGetList());case 12:_context5.next=18;break;case 14:_context5.prev=14;_context5.t0=_context5[\"catch\"](1);_context5.next=18;return put(InstallmentActions.onDeleteError(_context5.t0));case 18:case\"end\":return _context5.stop();}}},_marked5,null,[[1,14]]);}export function watchGetList(){return _regeneratorRuntime.wrap(function watchGetList$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return takeEvery(InstallmentActionTypes.GET_LIST,handleGetList);case 2:case\"end\":return _context6.stop();}}},_marked6);}export function watchGetDetail(){return _regeneratorRuntime.wrap(function watchGetDetail$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeEvery(InstallmentActionTypes.GET_DETAIL,handleGetDetail);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function watchCreate(){return _regeneratorRuntime.wrap(function watchCreate$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeEvery(InstallmentActionTypes.CREATE,handleCreate);case 2:case\"end\":return _context8.stop();}}},_marked8);}export function watchUpdate(){return _regeneratorRuntime.wrap(function watchUpdate$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return takeEvery(InstallmentActionTypes.UPDATE,handleUpdate);case 2:case\"end\":return _context9.stop();}}},_marked9);}export function watchDelete(){return _regeneratorRuntime.wrap(function watchDelete$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeEvery(InstallmentActionTypes.DELETE,handleDelete);case 2:case\"end\":return _context10.stop();}}},_marked10);}export default function rootSaga(){return _regeneratorRuntime.wrap(function rootSaga$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return all([fork(watchGetList),fork(watchGetDetail),fork(watchCreate),fork(watchUpdate),fork(watchDelete)]);case 2:case\"end\":return _context11.stop();}}},_marked11);}","map":{"version":3,"sources":["/Users/vyduong/Desktop/client/Home-ApumStore/src/redux/sagas/installment.js"],"names":["handleGetList","handleGetDetail","handleCreate","handleUpdate","handleDelete","watchGetList","watchGetDetail","watchCreate","watchUpdate","watchDelete","rootSaga","takeEvery","fork","all","call","put","get","InstallmentActions","InstallmentActionTypes","getAllInstallments","getDetailInstallment","addInstallment","updateInstallment","deleteInstallment","getUser","io","NotificationActions","socket","payload","result","data","code","onGetListSuccess","installments","total","onGetListError","filters","id","onGetDetailSuccess","installment","onGetDetailError","params","onCreateSuccess","onGetList","user","userRes","instRes","emit","email","onCreate","name","image","product","bigimage","link","type","content","onCreateError","detailResult","onUpdateSuccess","money","onUpdateError","onDeleteSuccess","onDeleteError","GET_LIST","GET_DETAIL","CREATE","UPDATE","DELETE"],"mappings":"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","sourcesContent":["import { takeEvery, fork, all, call, put } from \"redux-saga/effects\";\nimport { get } from \"lodash\";\nimport InstallmentActions, {\n  InstallmentActionTypes,\n} from \"../actions/installment\";\nimport {\n  getAllInstallments,\n  getDetailInstallment,\n  addInstallment,\n  updateInstallment,\n  deleteInstallment,\n} from \"../apis/installment\";\nimport { getUser } from \"../apis/user\";\n/* Notification */\nimport io from \"socket.io-client\";\nimport NotificationActions from \"../actions/notification\";\nconst socket = io(\"https://be-phonestore.herokuapp.com\");\n/* Notification */\n\nfunction* handleGetList({ payload }) {\n  try {\n    const result = yield call(getAllInstallments, payload);\n    const data = get(result, \"data\");\n    if (data.code !== 200) throw data;\n    yield put(\n      InstallmentActions.onGetListSuccess(data.installments, data.total)\n    );\n  } catch (error) {\n    yield put(InstallmentActions.onGetListError(error));\n  }\n}\n\nfunction* handleGetDetail({ filters, id }) {\n  try {\n    const result = yield call(getDetailInstallment, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield put(InstallmentActions.onGetDetailSuccess(data.installment));\n  } catch (error) {\n    yield put(InstallmentActions.onGetDetailError(error));\n  }\n}\n\n/**\n *\n * create\n */\nfunction* handleCreate({ payload }) {\n  try {\n    const result = yield call(addInstallment, payload.params);\n    const data = get(result, \"data\", {});\n    if (data.code !== 201) throw data;\n    yield put(InstallmentActions.onCreateSuccess(data.installment));\n    yield put(InstallmentActions.onGetList());\n    const userRes = yield call(getUser, payload.params.user);\n    const instRes = yield call(getDetailInstallment, data.installment.id);\n    /* Notification */\n    socket.emit(\"installment\", {\n      email: userRes.data.user.email,\n      installment: data.installment.id,\n    });\n    yield put(\n      NotificationActions.onCreate({\n        name: \"Yêu cầu trả góp mới cần duyệt\",\n        image: instRes.data.installment.product.id.bigimage.id,\n        link: data.installment.id,\n        type: 2,\n        content: `${userRes.data.user.email} vừa gửi yêu cầu trả góp cho sản phẩm`,\n      })\n    );\n    /* Notification */\n  } catch (error) {\n    yield put(InstallmentActions.onCreateError(error));\n  }\n}\n\n/**\n *\n * update\n */\nfunction* handleUpdate({ payload }) {\n  try {\n    const result = yield call(updateInstallment, payload.data, payload.id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    const detailResult = yield call(getDetailInstallment, payload.id);\n    yield put(InstallmentActions.onUpdateSuccess(get(detailResult, \"data\")));\n    yield put(InstallmentActions.onGetList());\n    const userRes = yield call(getUser, data.installment.user);\n    // Thanh toán thành công thì báo về cho admin\n    if (payload.data.money) {\n      socket.emit(\"installmentMoney\", {\n        email: userRes.data.user.email,\n        installment: data.installment.id,\n      });\n      yield put(\n        NotificationActions.onCreate({\n          type: 2,\n          user: null,\n          link: data.installment.id,\n          name: `Phiếu trả góp ${data.installment.id} vừa được thanh toán`,\n          image: detailResult.data.installment.product.id.bigimage.id,\n          content: `${data.installment.id} đã được thanh toán tại cửa hàng với số tiền là ${payload.data.money} VND`,\n        })\n      );\n    }\n  } catch (error) {\n    yield put(InstallmentActions.onUpdateError(error));\n  }\n}\n\n/**\n *\n * delete\n */\nfunction* handleDelete({ id }) {\n  try {\n    const result = yield call(deleteInstallment, id);\n    const data = get(result, \"data\", {});\n    if (data.code !== 200) throw data;\n    yield put(InstallmentActions.onDeleteSuccess(data));\n    yield put(InstallmentActions.onGetList());\n  } catch (error) {\n    yield put(InstallmentActions.onDeleteError(error));\n  }\n}\n\nexport function* watchGetList() {\n  yield takeEvery(InstallmentActionTypes.GET_LIST, handleGetList);\n}\nexport function* watchGetDetail() {\n  yield takeEvery(InstallmentActionTypes.GET_DETAIL, handleGetDetail);\n}\nexport function* watchCreate() {\n  yield takeEvery(InstallmentActionTypes.CREATE, handleCreate);\n}\nexport function* watchUpdate() {\n  yield takeEvery(InstallmentActionTypes.UPDATE, handleUpdate);\n}\nexport function* watchDelete() {\n  yield takeEvery(InstallmentActionTypes.DELETE, handleDelete);\n}\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchGetList),\n    fork(watchGetDetail),\n    fork(watchCreate),\n    fork(watchUpdate),\n    fork(watchDelete),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}