{"ast":null,"code":"import _toConsumableArray from\"/Users/vyduong/Desktop/client/Home-ApumStore/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{ProductsActionTypes}from\"../actions/products\";import{toastSuccess}from'../../utils/toastHelper';// lấy những sản phẩm đã được lưu trong localStorage về\nvar data=JSON.parse(localStorage.getItem('CART'));var initialState=data?data:[];var cart=function cart(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var product=action.product,color=action.color,quantity=action.quantity,order_list=action.order_list;var index=-1;switch(action.type){case ProductsActionTypes.ADD_PRODUCT_TO_CART:index=findProductInCart(state,product,color);if(index!==-1){state[index].quantity+=quantity;//cộng với 1\n}else{state.push({product:product,color:color,quantity:quantity});}localStorage.setItem('CART',JSON.stringify(state));toastSuccess('Đã thêm vào giỏ hàng');return _toConsumableArray(state);case ProductsActionTypes.DELETE_PRODUCT_CART:index=findProductInCart(state,product,color);if(index!==-1){state.splice(index,1);// cắt đi từ vị trí index, cắt 1 phần tử\n}localStorage.setItem('CART',JSON.stringify(state));toastSuccess('Đã xóa khỏi giỏ hàng');return _toConsumableArray(state);case ProductsActionTypes.UPDATE_PRODUCT_CART:index=findProductInCart(state,product,color);if(index!==-1){state[index].product=product;state[index].quantity=quantity;}localStorage.setItem('CART',JSON.stringify(state));return _toConsumableArray(state);case ProductsActionTypes.PURCHASE_AGAIN:// order_list : cart=[] mới truyền vào\n/* eslint-disable */order_list.map(function(item,index){order_list[index].color=item.color.id;order_list[index].product={id:item.product,bigimage:{publicUrl:item.image},name:item.name,colors:[{id:item.color,nameEn:item.nameColor,price:item.price}]};var _index=findProductInCart(state,order_list[index].product,order_list[index].color);if(_index===-1){order_list[index].quantity=item.quantity;}else{order_list[index].quantity=item.quantity+state[_index].quantity;}});state=order_list;localStorage.setItem('CART',JSON.stringify(state));return _toConsumableArray(state);/* eslint-disable */case ProductsActionTypes.CLEAR_CART:var _action$payload=action.payload,cart=_action$payload.cart,checkout=_action$payload.checkout;cart=cart.filter(function(ar){return!checkout.find(function(rm){return rm.product.id===ar.product.id&&ar.color===rm.color;});});localStorage.setItem('CART',JSON.stringify(cart));return cart;default:return _toConsumableArray(state);}};var findProductInCart=function findProductInCart(cart,product,productColor){//Trường hợp không tìm thấy\nvar index=-1;if(cart.length>0){for(var i=0;i<cart.length;i++){// xem coi các product trong mảng cart có tồn tại product mới chọn ko?\nif(cart[i].color===productColor&&cart[i].product.id===product.id){index=i;//trả về vị trí\nbreak;}}}return index;};export default cart;","map":{"version":3,"sources":["/Users/vyduong/Desktop/client/Home-ApumStore/src/redux/reducers/cart.js"],"names":["ProductsActionTypes","toastSuccess","data","JSON","parse","localStorage","getItem","initialState","cart","state","action","product","color","quantity","order_list","index","type","ADD_PRODUCT_TO_CART","findProductInCart","push","setItem","stringify","DELETE_PRODUCT_CART","splice","UPDATE_PRODUCT_CART","PURCHASE_AGAIN","map","item","id","bigimage","publicUrl","image","name","colors","nameEn","nameColor","price","_index","CLEAR_CART","payload","checkout","filter","ar","find","rm","productColor","length","i"],"mappings":"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","sourcesContent":["import { ProductsActionTypes } from \"../actions/products\";\nimport { toastSuccess } from '../../utils/toastHelper';\n\n// lấy những sản phẩm đã được lưu trong localStorage về\nvar data = JSON.parse(localStorage.getItem('CART'));\n\nvar initialState = data ? data : [];\n\nconst cart = (state = initialState, action) =>{\n  var {product, color, quantity, order_list} = action;\n  var index = -1;\n  switch (action.type){\n    case ProductsActionTypes.ADD_PRODUCT_TO_CART:\n      index = findProductInCart(state, product, color);\n      if(index !== -1){\n        state[index].quantity += quantity;  //cộng với 1\n      }else{\n        state.push({\n          product,\n          color,\n          quantity\n        });\n      }\n      localStorage.setItem('CART', JSON.stringify(state));\n      toastSuccess('Đã thêm vào giỏ hàng');\n      return [...state];\n    case ProductsActionTypes.DELETE_PRODUCT_CART:\n      index = findProductInCart(state, product, color);\n      if(index !== -1){\n        state.splice(index, 1);  // cắt đi từ vị trí index, cắt 1 phần tử\n      }\n      localStorage.setItem('CART', JSON.stringify(state));\n      toastSuccess('Đã xóa khỏi giỏ hàng');\n      return [...state];\n    case ProductsActionTypes.UPDATE_PRODUCT_CART:\n      index = findProductInCart(state, product, color);\n      if(index !== -1){\n        state[index].product = product;\n        state[index].quantity = quantity;\n      }\n      localStorage.setItem('CART', JSON.stringify(state));\n      return [...state];\n    case ProductsActionTypes.PURCHASE_AGAIN:\n      // order_list : cart=[] mới truyền vào\n      /* eslint-disable */\n      order_list.map((item, index) => {\n        order_list[index].color = item.color.id;\n        order_list[index].product = {\n          id: item.product,\n          bigimage: {\n            publicUrl: item.image,\n          },\n          name : item.name,\n          colors: [\n            {\n              id: item.color,\n              nameEn: item.nameColor,\n              price: item.price\n            }\n          ]\n        };\n        var _index = findProductInCart(state, order_list[index].product, order_list[index].color)\n        if(_index === -1){\n          order_list[index].quantity = item.quantity\n        }\n        else{\n          order_list[index].quantity = item.quantity+state[_index].quantity\n        }\n      })\n      state = order_list\n      localStorage.setItem('CART', JSON.stringify(state));\n      return [...state]\n      /* eslint-disable */\n    case ProductsActionTypes.CLEAR_CART:\n      var {cart, checkout} = action.payload\n      cart = cart.filter(ar => !checkout.find(rm => (rm.product.id === ar.product.id && ar.color === rm.color) ))\n      localStorage.setItem('CART', JSON.stringify(cart));\n      return cart\n    default : return [...state]\n  }\n}\n\nconst findProductInCart = (cart, product, productColor) => {\n  //Trường hợp không tìm thấy\n  var index = -1;\n  if(cart.length>0){\n    for(var i=0; i<cart.length; i++){\n      // xem coi các product trong mảng cart có tồn tại product mới chọn ko?\n      if(cart[i].color === productColor && cart[i].product.id === product.id){\n        index = i;  //trả về vị trí\n        break;\n      }\n    }\n  }\n  return index;\n}\n\nexport default cart;"]},"metadata":{},"sourceType":"module"}